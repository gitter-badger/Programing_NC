;DEF NCK REAL DRESS_STA;修整判断(0/1,是/否) 	
;DEF NCK REAL OPERA_STA ;是否对刀(0/1,是/否)
;DEF NCK REAL ARTIFACT_TYPE;工件类型小循环（0/1/2,螺纹/蜗杆/环形槽）
;DEF NCK INT TECH_TIME_R;粗磨次数
;DEF NCK INT TECH_TIME_MR;半粗磨次数
;DEF NCK INT TECH_TIME_MF;半精磨次数
;DEF NCK INT TECH_TIME_F;精磨次数
;DEF NCK INT TECH_TIME_RCURNT;当前粗磨次数
;DEF NCK INT TECH_TIME_MRCURNT;当前半粗磨次数
;DEF NCK INT TECH_TIME_MFCURNT;当前半精磨次数
;DEF NCK INT TECH_TIME_FCURNT;当前精磨次数
;--------------------------------------------------------------------------
PAR_INI;参数初始化子程序
;--------------------------------------------------------------------------
DRESS_STA=$A_DBB[0];是否修整
IF DRESS_STA==1
    DRESSER
    RET
ENDIF
;--------------------------------------------------------------------------
OPERA_STA=$A_DBB[1];是否对刀
IF OPERA_STA==1
    TOOL_SET
    RET
ENDIF
;--------------------------------------------------------------------------
IF TECH_TIME_R+TECH_TIME_MR+TECH_TIME_MF+TECH_TIME_F==0;工艺参数中设置的总磨削次数
    RET
ENDIF
;--------------------------------------------------------------------------
WHILE(TECH_TIME_RCURNT+TECH_TIME_MRCURNT+TECH_TIME_MFCURNT+TECH_TIME_FCURNT<=TECH_TIME_R+TECH_TIME_MR+TECH_TIME_MF+TECH_TIME_F)
    STOPRE
	S_CYCLE ;工件类型
	INI_ANGLE;初始角度计算
	S_BCYC;工序进给大循环判断
	S_LINESPEED_GRIND;磨削时砂轮速度调节子程序
ENDWHILE
;--------------------------------------------------------------------------

;S_GRINDING_END
RET
